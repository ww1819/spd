<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.spd.biz.mapper.EquipmentPurchaseApplicationMapper">
    
    <resultMap type="EquipmentPurchaseApplication" id="EquipmentPurchaseApplicationResult">
        <result property="id"    column="id"    />
        <result property="applicationNo"    column="application_no"    />
        <result property="applicationTitle"    column="application_title"    />
        <result property="equipmentName"    column="equipment_name"    />
        <result property="equipmentModel"    column="equipment_model"    />
        <result property="equipmentSpecification"    column="equipment_specification"    />
        <result property="equipmentBrand"    column="equipment_brand"    />
        <result property="quantity"    column="quantity"    />
        <result property="unitPrice"    column="unit_price"    />
        <result property="totalAmount"    column="total_amount"    />
        <result property="budgetAmount"    column="budget_amount"    />
        <result property="urgencyLevel"    column="urgency_level"    />
        <result property="applicationReason"    column="application_reason"    />
        <result property="technicalRequirements"    column="technical_requirements"    />
        <result property="supplierSuggestion"    column="supplier_suggestion"    />
        <result property="expectedDeliveryDate"    column="expected_delivery_date"    />
        <result property="applicationDepartment"    column="application_department"    />
        <result property="applicant"    column="applicant"    />
        <result property="applicantPhone"    column="applicant_phone"    />
        <result property="applicationDate"    column="application_date"    />
        <result property="status"    column="status"    />
        <result property="reviewer"    column="reviewer"    />
        <result property="reviewDate"    column="review_date"    />
        <result property="reviewOpinion"    column="review_opinion"    />
        <result property="purchaseOrderNo"    column="purchase_order_no"    />
        <result property="purchaseDate"    column="purchase_date"    />
        <result property="actualAmount"    column="actual_amount"    />
        <result property="deliveryDate"    column="delivery_date"    />
        <result property="installationDate"    column="installation_date"    />
        <result property="acceptanceDate"    column="acceptance_date"    />
        <result property="warrantyPeriod"    column="warranty_period"    />
        <result property="maintenanceContact"    column="maintenance_contact"    />
        <result property="maintenancePhone"    column="maintenance_phone"    />
        <result property="remark"    column="remark"    />
        <result property="delFlag"    column="del_flag"    />
        <result property="createBy"    column="create_by"    />
        <result property="createTime"    column="create_time"    />
        <result property="updateBy"    column="update_by"    />
        <result property="updateTime"    column="update_time"    />
    </resultMap>

    <sql id="selectEquipmentPurchaseApplicationVo">
        select id, application_no, application_title, equipment_name, equipment_model, equipment_specification, equipment_brand, quantity, unit_price, total_amount, budget_amount, urgency_level, application_reason, technical_requirements, supplier_suggestion, expected_delivery_date, application_department, applicant, applicant_phone, application_date, status, reviewer, review_date, review_opinion, purchase_order_no, purchase_date, actual_amount, delivery_date, installation_date, acceptance_date, warranty_period, maintenance_contact, maintenance_phone, remark, del_flag, create_by, create_time, update_by, update_time from equipment_purchase_application
    </sql>

    <select id="selectEquipmentPurchaseApplicationList" parameterType="EquipmentPurchaseApplication" resultMap="EquipmentPurchaseApplicationResult">
        <include refid="selectEquipmentPurchaseApplicationVo"/>
        <where>  
            <if test="applicationNo != null  and applicationNo != ''"> and application_no like concat('%', #{applicationNo}, '%')</if>
            <if test="applicationTitle != null  and applicationTitle != ''"> and application_title like concat('%', #{applicationTitle}, '%')</if>
            <if test="equipmentName != null  and equipmentName != ''"> and equipment_name like concat('%', #{equipmentName}, '%')</if>
            <if test="equipmentModel != null  and equipmentModel != ''"> and equipment_model like concat('%', #{equipmentModel}, '%')</if>
            <if test="equipmentBrand != null  and equipmentBrand != ''"> and equipment_brand like concat('%', #{equipmentBrand}, '%')</if>
            <if test="urgencyLevel != null  and urgencyLevel != ''"> and urgency_level = #{urgencyLevel}</if>
            <if test="applicationDepartment != null  and applicationDepartment != ''"> and application_department like concat('%', #{applicationDepartment}, '%')</if>
            <if test="applicant != null  and applicant != ''"> and applicant like concat('%', #{applicant}, '%')</if>
            <if test="status != null  and status != ''"> and status = #{status}</if>
            <if test="reviewer != null  and reviewer != ''"> and reviewer like concat('%', #{reviewer}, '%')</if>
            <if test="purchaseOrderNo != null  and purchaseOrderNo != ''"> and purchase_order_no like concat('%', #{purchaseOrderNo}, '%')</if>
            <if test="params.beginApplicationDate != null and params.beginApplicationDate != ''"><!-- 开始申请日期检索 -->
                and date_format(application_date,'%y%m%d') &gt;= date_format(#{params.beginApplicationDate},'%y%m%d')
            </if>
            <if test="params.endApplicationDate != null and params.endApplicationDate != ''"><!-- 结束申请日期检索 -->
                and date_format(application_date,'%y%m%d') &lt;= date_format(#{params.endApplicationDate},'%y%m%d')
            </if>
            <if test="params.beginExpectedDeliveryDate != null and params.beginExpectedDeliveryDate != ''"><!-- 开始期望交货日期检索 -->
                and date_format(expected_delivery_date,'%y%m%d') &gt;= date_format(#{params.beginExpectedDeliveryDate},'%y%m%d')
            </if>
            <if test="params.endExpectedDeliveryDate != null and params.endExpectedDeliveryDate != ''"><!-- 结束期望交货日期检索 -->
                and date_format(expected_delivery_date,'%y%m%d') &lt;= date_format(#{params.endExpectedDeliveryDate},'%y%m%d')
            </if>
            and del_flag = '0'
        </where>
        order by application_date desc
    </select>
    
    <select id="selectEquipmentPurchaseApplicationById" parameterType="String" resultMap="EquipmentPurchaseApplicationResult">
        <include refid="selectEquipmentPurchaseApplicationVo"/>
        where id = #{id} and del_flag = '0'
    </select>
        
    <insert id="insertEquipmentPurchaseApplication" parameterType="EquipmentPurchaseApplication" useGeneratedKeys="false">
        insert into equipment_purchase_application
        <trim prefix="(" suffix=")" suffixOverrides=",">
            <if test="id != null">id,</if>
            <if test="applicationNo != null">application_no,</if>
            <if test="applicationTitle != null">application_title,</if>
            <if test="equipmentName != null">equipment_name,</if>
            <if test="equipmentModel != null">equipment_model,</if>
            <if test="equipmentSpecification != null">equipment_specification,</if>
            <if test="equipmentBrand != null">equipment_brand,</if>
            <if test="quantity != null">quantity,</if>
            <if test="unitPrice != null">unit_price,</if>
            <if test="totalAmount != null">total_amount,</if>
            <if test="budgetAmount != null">budget_amount,</if>
            <if test="urgencyLevel != null">urgency_level,</if>
            <if test="applicationReason != null">application_reason,</if>
            <if test="technicalRequirements != null">technical_requirements,</if>
            <if test="supplierSuggestion != null">supplier_suggestion,</if>
            <if test="expectedDeliveryDate != null">expected_delivery_date,</if>
            <if test="applicationDepartment != null">application_department,</if>
            <if test="applicant != null">applicant,</if>
            <if test="applicantPhone != null">applicant_phone,</if>
            <if test="applicationDate != null">application_date,</if>
            <if test="status != null">status,</if>
            <if test="reviewer != null">reviewer,</if>
            <if test="reviewDate != null">review_date,</if>
            <if test="reviewOpinion != null">review_opinion,</if>
            <if test="purchaseOrderNo != null">purchase_order_no,</if>
            <if test="purchaseDate != null">purchase_date,</if>
            <if test="actualAmount != null">actual_amount,</if>
            <if test="deliveryDate != null">delivery_date,</if>
            <if test="installationDate != null">installation_date,</if>
            <if test="acceptanceDate != null">acceptance_date,</if>
            <if test="warrantyPeriod != null">warranty_period,</if>
            <if test="maintenanceContact != null">maintenance_contact,</if>
            <if test="maintenancePhone != null">maintenance_phone,</if>
            <if test="remark != null">remark,</if>
            <if test="delFlag != null">del_flag,</if>
            <if test="createBy != null">create_by,</if>
            <if test="createTime != null">create_time,</if>
            <if test="updateBy != null">update_by,</if>
            <if test="updateTime != null">update_time,</if>
         </trim>
        <trim prefix="values (" suffix=")" suffixOverrides=",">
            <if test="id != null">#{id},</if>
            <if test="applicationNo != null">#{applicationNo},</if>
            <if test="applicationTitle != null">#{applicationTitle},</if>
            <if test="equipmentName != null">#{equipmentName},</if>
            <if test="equipmentModel != null">#{equipmentModel},</if>
            <if test="equipmentSpecification != null">#{equipmentSpecification},</if>
            <if test="equipmentBrand != null">#{equipmentBrand},</if>
            <if test="quantity != null">#{quantity},</if>
            <if test="unitPrice != null">#{unitPrice},</if>
            <if test="totalAmount != null">#{totalAmount},</if>
            <if test="budgetAmount != null">#{budgetAmount},</if>
            <if test="urgencyLevel != null">#{urgencyLevel},</if>
            <if test="applicationReason != null">#{applicationReason},</if>
            <if test="technicalRequirements != null">#{technicalRequirements},</if>
            <if test="supplierSuggestion != null">#{supplierSuggestion},</if>
            <if test="expectedDeliveryDate != null">#{expectedDeliveryDate},</if>
            <if test="applicationDepartment != null">#{applicationDepartment},</if>
            <if test="applicant != null">#{applicant},</if>
            <if test="applicantPhone != null">#{applicantPhone},</if>
            <if test="applicationDate != null">#{applicationDate},</if>
            <if test="status != null">#{status},</if>
            <if test="reviewer != null">#{reviewer},</if>
            <if test="reviewDate != null">#{reviewDate},</if>
            <if test="reviewOpinion != null">#{reviewOpinion},</if>
            <if test="purchaseOrderNo != null">#{purchaseOrderNo},</if>
            <if test="purchaseDate != null">#{purchaseDate},</if>
            <if test="actualAmount != null">#{actualAmount},</if>
            <if test="deliveryDate != null">#{deliveryDate},</if>
            <if test="installationDate != null">#{installationDate},</if>
            <if test="acceptanceDate != null">#{acceptanceDate},</if>
            <if test="warrantyPeriod != null">#{warrantyPeriod},</if>
            <if test="maintenanceContact != null">#{maintenanceContact},</if>
            <if test="maintenancePhone != null">#{maintenancePhone},</if>
            <if test="remark != null">#{remark},</if>
            <if test="delFlag != null">#{delFlag},</if>
            <if test="createBy != null">#{createBy},</if>
            <if test="createTime != null">#{createTime},</if>
            <if test="updateBy != null">#{updateBy},</if>
            <if test="updateTime != null">#{updateTime},</if>
         </trim>
    </insert>

    <update id="updateEquipmentPurchaseApplication" parameterType="EquipmentPurchaseApplication">
        update equipment_purchase_application
        <trim prefix="SET" suffixOverrides=",">
            <if test="applicationNo != null">application_no = #{applicationNo},</if>
            <if test="applicationTitle != null">application_title = #{applicationTitle},</if>
            <if test="equipmentName != null">equipment_name = #{equipmentName},</if>
            <if test="equipmentModel != null">equipment_model = #{equipmentModel},</if>
            <if test="equipmentSpecification != null">equipment_specification = #{equipmentSpecification},</if>
            <if test="equipmentBrand != null">equipment_brand = #{equipmentBrand},</if>
            <if test="quantity != null">quantity = #{quantity},</if>
            <if test="unitPrice != null">unit_price = #{unitPrice},</if>
            <if test="totalAmount != null">total_amount = #{totalAmount},</if>
            <if test="budgetAmount != null">budget_amount = #{budgetAmount},</if>
            <if test="urgencyLevel != null">urgency_level = #{urgencyLevel},</if>
            <if test="applicationReason != null">application_reason = #{applicationReason},</if>
            <if test="technicalRequirements != null">technical_requirements = #{technicalRequirements},</if>
            <if test="supplierSuggestion != null">supplier_suggestion = #{supplierSuggestion},</if>
            <if test="expectedDeliveryDate != null">expected_delivery_date = #{expectedDeliveryDate},</if>
            <if test="applicationDepartment != null">application_department = #{applicationDepartment},</if>
            <if test="applicant != null">applicant = #{applicant},</if>
            <if test="applicantPhone != null">applicant_phone = #{applicantPhone},</if>
            <if test="applicationDate != null">application_date = #{applicationDate},</if>
            <if test="status != null">status = #{status},</if>
            <if test="reviewer != null">reviewer = #{reviewer},</if>
            <if test="reviewDate != null">review_date = #{reviewDate},</if>
            <if test="reviewOpinion != null">review_opinion = #{reviewOpinion},</if>
            <if test="purchaseOrderNo != null">purchase_order_no = #{purchaseOrderNo},</if>
            <if test="purchaseDate != null">purchase_date = #{purchaseDate},</if>
            <if test="actualAmount != null">actual_amount = #{actualAmount},</if>
            <if test="deliveryDate != null">delivery_date = #{deliveryDate},</if>
            <if test="installationDate != null">installation_date = #{installationDate},</if>
            <if test="acceptanceDate != null">acceptance_date = #{acceptanceDate},</if>
            <if test="warrantyPeriod != null">warranty_period = #{warrantyPeriod},</if>
            <if test="maintenanceContact != null">maintenance_contact = #{maintenanceContact},</if>
            <if test="maintenancePhone != null">maintenance_phone = #{maintenancePhone},</if>
            <if test="remark != null">remark = #{remark},</if>
            <if test="delFlag != null">del_flag = #{delFlag},</if>
            <if test="createBy != null">create_by = #{createBy},</if>
            <if test="createTime != null">create_time = #{createTime},</if>
            <if test="updateBy != null">update_by = #{updateBy},</if>
            <if test="updateTime != null">update_time = #{updateTime},</if>
        </trim>
        where id = #{id}
    </update>

    <delete id="deleteEquipmentPurchaseApplicationById" parameterType="String">
        update equipment_purchase_application set del_flag = '2' where id = #{id}
    </delete>

    <delete id="deleteEquipmentPurchaseApplicationByIds" parameterType="String">
        update equipment_purchase_application set del_flag = '2' where id in 
        <foreach item="id" collection="array" open="(" separator="," close=")">
            #{id}
        </foreach>
    </delete>
</mapper> 